<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Ruby and the singleton pattern don&#39;t get along</title>
  <meta name="description" content="Many design patterns that originated in other object-oriented languages have elegant Ruby translations. However, the Singleton stands out as a construct that...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://yourdomain.com/articles/ruby-and-the-singleton-pattern-dont-get-along">
  <link rel="alternate" type="application/rss+xml" title="Practicing Ruby" href="http://yourdomain.com/feed.xml">
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-33127211-2', 'auto');
    ga('send', 'pageview');
  </script>
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Practicing Ruby</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        <a class="page-link" href="/about">About</a>
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Ruby and the singleton pattern don't get along</h1>
    <p class="post-meta"><time datetime="2011-10-11T00:00:00-04:00" itemprop="datePublished">Oct 11, 2011</time> • Gregory Brown</p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <p>Many design patterns that originated in other object-oriented languages have elegant Ruby translations. However, the <a href="http://en.wikipedia.org/wiki/Singleton_pattern">Singleton</a> stands out as a construct that seems to have no good way to implement in Ruby. In this article, I will walk through the different options and explain why they all have something wrong with them. But first, we need a working definition of the singleton pattern to make sure we’re on the same page.</p>

<p>Put briefly, the singleton pattern is a clever way of implementing global objects that you never need to explicitly instantiate. Not to be confused with Ruby’s mostly unrelated concept of a “singleton class,” the singleton pattern is applied when only a single instance of an object is needed across an entire application. Typical examples include objects that represent configuration data, global logging systems, and other similar structures. But there are also some subtle use cases in Ruby due to the fact that classes and modules are objects. For example, we have the <code class="highlighter-rouge">Math</code> module on which we can call methods such as <code class="highlighter-rouge">Math.sin()</code>, and <code class="highlighter-rouge">Math.cos()</code>. The <code class="highlighter-rouge">Math</code> module is acting as a singleton object in this context, even if it’s not immediately obvious to the user. Keep in mind while reading this article that I’ve lumped this sort of use case in with the more traditional ones, as it shifts the perspective somewhat.</p>

<p>There are a lot of different ways to implement this general pattern in Ruby, but as I’ve already mentioned, they all pretty much suck. That said, studying this problem can teach us a thing or two about the subtleties (and warts) of the Ruby object system. As you read along, try figuring out the downsides of each implementation before moving on to read my explanations. This exercise will make the article more interesting and may even uncover some fresh ideas that I haven’t considered yet.</p>

<h3 id="using-the-singleton-module-provided-by-the-standard-library">Using the <code class="highlighter-rouge">Singleton</code> module provided by the standard library</h3>

<p>Ruby provides a standard library to assist in implementing the singleton pattern. The following code (originally from Practicing Ruby 1.25) illustrates how you can use this library to build a simple logger object.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="nb">require</span> <span class="s2">"singleton"</span>

<span class="k">class</span> <span class="nc">SimpleLogger</span>
  <span class="kp">include</span> <span class="no">Singleton</span>

  <span class="k">def</span> <span class="nf">initialize</span>
    <span class="vi">@output</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">end</span>

  <span class="kp">attr_reader</span> <span class="ss">:output</span>

  <span class="k">def</span> <span class="nf">error</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">&lt;&lt;</span> <span class="n">formatted_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s2">"ERROR"</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">&lt;&lt;</span> <span class="n">formatted_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s2">"INFO"</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="n">f</span> <span class="o">&lt;&lt;</span> <span class="n">output</span><span class="p">.</span><span class="nf">join</span> <span class="p">}</span>
  <span class="k">end</span>

  <span class="kp">private</span>

  <span class="k">def</span> <span class="nf">formatted_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">message_type</span><span class="p">)</span>
    <span class="s2">"</span><span class="si">#{</span><span class="no">Time</span><span class="p">.</span><span class="nf">now</span><span class="si">}</span><span class="s2"> | </span><span class="si">#{</span><span class="n">message_type</span><span class="si">}</span><span class="s2">: </span><span class="si">#{</span><span class="n">message</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<p>By including the <code class="highlighter-rouge">Singleton</code> module, we make it so that it is no longer possible to create an instance of the <code class="highlighter-rouge">SimpleLogger</code> class in an ordinary way.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt; logger = SimpleLogger.new
NoMethodError: private method `new' called for SimpleLogger:Class
  from (irb):2
</code></pre>
</div>

<p>This behavior makes sense, because the point of the singleton pattern is to prevent multiple instances of a given object from being created. This example code shows how to get at a <code class="highlighter-rouge">SimpleLogger</code> instance in a way that guarantees that only one will be created.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">logger</span> <span class="o">=</span> <span class="no">SimpleLogger</span><span class="p">.</span><span class="nf">instance</span>

<span class="n">logger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="s2">"Some serious problem"</span><span class="p">)</span>
<span class="n">logger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s2">"Something you might want to know"</span><span class="p">)</span>
<span class="n">logger</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="s2">"log.txt"</span><span class="p">)</span>
</code></pre>
</div>

<p>This interface is a bit cumbersome to work with, but it gets the job done, and on its own isn’t too bad. However, disabling <code class="highlighter-rouge">new</code> and adding an <code class="highlighter-rouge">instance</code> method isn’t all that the <code class="highlighter-rouge">Singleton</code> module does. It also does all of the following things:</p>

<ul>
  <li>Overrides <code class="highlighter-rouge">inherited()</code> on the class to ensure that subclasses also retain <code class="highlighter-rouge">Singleton</code> behavior</li>
  <li>Overrides <code class="highlighter-rouge">dup()</code>/<code class="highlighter-rouge">clone()</code> on the class to ensure that copied classes also retain <code class="highlighter-rouge">Singleton</code> behavior</li>
  <li>Overrides <code class="highlighter-rouge">_load()</code> to call <code class="highlighter-rouge">instance()</code>, modifying <code class="highlighter-rouge">Marshal</code> loading behavior to return the single instance</li>
  <li>Overrides <code class="highlighter-rouge">_dump()</code> to strip state information when serializing via <code class="highlighter-rouge">Marshal</code></li>
  <li>Overrides <code class="highlighter-rouge">dup()</code>/<code class="highlighter-rouge">clone()</code> on the instance to raise a <code class="highlighter-rouge">TypeError</code>, preventing cloning or duping of the instance</li>
</ul>

<p>When you think about what a singleton object is actually meant to be, these changes make sense. However, many Rubyists look at this and see a whole lot of complexity without a lot of direct benefits. This impression causes many folks to avoid the use of the <code class="highlighter-rouge">Singleton</code> module in favor of implementations that are a bit more low ceremony. These implementations tend to ignore some of the edge cases that the <code class="highlighter-rouge">Singleton</code> module accounts for but are much easier to understand.</p>

<h3 id="using-a-class-consisting-of-only-class-methods">Using a class consisting of only class methods</h3>

<p>The following code uses ordinary class methods as an alternative to the previous approach. We explicitly call <code class="highlighter-rouge">undef_method</code> to make it so that instances of this class cannot be created, but otherwise this code is a vanilla Ruby class definition.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">SimpleLogger</span>
  <span class="k">class</span> <span class="o">&lt;&lt;</span> <span class="nb">self</span>
    <span class="n">undef_method</span> <span class="ss">:new</span>

    <span class="k">def</span> <span class="nf">output</span>
      <span class="vi">@output</span> <span class="o">||=</span> <span class="p">[]</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">error</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
      <span class="n">output</span> <span class="o">&lt;&lt;</span> <span class="n">formatted_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s2">"ERROR"</span><span class="p">)</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
      <span class="n">output</span> <span class="o">&lt;&lt;</span> <span class="n">formatted_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s2">"INFO"</span><span class="p">)</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
      <span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="n">f</span> <span class="o">&lt;&lt;</span> <span class="n">output</span><span class="p">.</span><span class="nf">join</span> <span class="p">}</span>
    <span class="k">end</span>

    <span class="kp">private</span>

    <span class="k">def</span> <span class="nf">formatted_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">message_type</span><span class="p">)</span>
      <span class="s2">"</span><span class="si">#{</span><span class="no">Time</span><span class="p">.</span><span class="nf">now</span><span class="si">}</span><span class="s2"> | </span><span class="si">#{</span><span class="n">message_type</span><span class="si">}</span><span class="s2">: </span><span class="si">#{</span><span class="n">message</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Using this class is very simple, as the entire API consists of class method calls.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="no">SimpleLogger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="s2">"Some serious problem"</span><span class="p">)</span>
<span class="no">SimpleLogger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s2">"Something you might want to know"</span><span class="p">)</span>
<span class="no">SimpleLogger</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="s2">"log.txt"</span><span class="p">)</span>
</code></pre>
</div>

<p>This approach isn’t too bad, but it has its own set of caveats. The use of <code class="highlighter-rouge">undef_method</code> to disable the <code class="highlighter-rouge">new</code> method makes our <code class="highlighter-rouge">Class</code> object into something that is some ways class-like, but isn’t quite a class anymore. From a purity standpoint, something just feels wrong about a construct that can exist in an inheritance hierarchy but cannot be instantiated. There is also the question of whether it ever really makes sense to create a subclass of a singleton object.</p>

<p>For a number of reasons, these philosophical issues tend to push folks in the direction of Ruby’s <code class="highlighter-rouge">Module</code> construct, which at first glance seems to address some of these problems.</p>

<h3 id="using-a-module-consisting-of-only-module-methods">Using a module consisting of only module methods</h3>

<p>Every module is an object that cannot exist in a hierarchy and cannot be instantiated but otherwise holds similar properties of <code class="highlighter-rouge">Class</code> objects. Note how similar this code is to our previous example.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">module</span> <span class="nn">SimpleLogger</span>
  <span class="k">class</span> <span class="o">&lt;&lt;</span> <span class="nb">self</span>
    <span class="k">def</span> <span class="nf">output</span>
      <span class="vi">@output</span> <span class="o">||=</span> <span class="p">[]</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">error</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
      <span class="n">output</span> <span class="o">&lt;&lt;</span> <span class="n">formatted_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s2">"ERROR"</span><span class="p">)</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
      <span class="n">output</span> <span class="o">&lt;&lt;</span> <span class="n">formatted_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s2">"INFO"</span><span class="p">)</span>
    <span class="k">end</span>

    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
      <span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="n">f</span> <span class="o">&lt;&lt;</span> <span class="n">output</span><span class="p">.</span><span class="nf">join</span> <span class="p">}</span>
    <span class="k">end</span>

    <span class="kp">private</span>

    <span class="k">def</span> <span class="nf">formatted_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">message_type</span><span class="p">)</span>
      <span class="s2">"</span><span class="si">#{</span><span class="no">Time</span><span class="p">.</span><span class="nf">now</span><span class="si">}</span><span class="s2"> | </span><span class="si">#{</span><span class="n">message_type</span><span class="si">}</span><span class="s2">: </span><span class="si">#{</span><span class="n">message</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<p>The two approaches are so similar that they look identical from the end user’s perspective:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="no">SimpleLogger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="s2">"Some serious problem"</span><span class="p">)</span>
<span class="no">SimpleLogger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s2">"Something you might want to know"</span><span class="p">)</span>
<span class="no">SimpleLogger</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="s2">"log.txt"</span><span class="p">)</span>
</code></pre>
</div>

<p>Of course, if we look under the hood, we find that these two implementations are quite different. Although it’s true that we’ve effectively made it impossible to create a subclass of <code class="highlighter-rouge">SimpleLogger</code> and that we didn’t have to explicitly disable the <code class="highlighter-rouge">new</code> method because <code class="highlighter-rouge">Module</code> does not provide one, we now are faced with the problem that this module can be mixed into other objects.</p>

<p>Just as a class can have methods at the class level and the instance level, a module can have methods at the module level and the “mixin” level. Our <code class="highlighter-rouge">SimpleLogger</code> code defines all of its methods at the module level, which means that mixing it into an object via <code class="highlighter-rouge">include</code> or <code class="highlighter-rouge">extend</code> will not add any new functionality to the object it gets mixed into. From a purity standpoint, this approach is pretty much identical to the “useless instances” that would be possible for us to create if we allowed calls to the <code class="highlighter-rouge">new</code> method in our class-based <code class="highlighter-rouge">SimpleLogger</code>. Modules therefore don’t actually give us much of an advantage over classes after all.</p>

<p>To make matters more confusing, Ruby provides us with a couple additional ways to use modules to implement the singleton pattern that bring new kinds of complexity into the mix.</p>

<h3 id="using-a-module-with-modulefunction">Using a module with <code class="highlighter-rouge">module_function</code></h3>

<p>If I were to create a list of Ruby’s most confusing features, <code class="highlighter-rouge">module_function</code> would be near the top. It is a keyword (like <code class="highlighter-rouge">private</code> and <code class="highlighter-rouge">protected</code>), which allows you to specify certain methods within a module to be callable at the module level. This feature seems useful at a glance and is even used by Ruby’s <code class="highlighter-rouge">Math</code> module. The interesting thing about module methods is that they serve as public methods on the module itself but get mixed into other objects as private methods.</p>

<p>This example code demonstrates directly calling methods on the <code class="highlighter-rouge">Math</code> module, which looks similar to our previous module-based singleton pattern example.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Point</span>
  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="vi">@x</span> <span class="o">=</span> <span class="n">x</span>
    <span class="vi">@y</span> <span class="o">=</span> <span class="n">y</span>
  <span class="k">end</span>

  <span class="kp">attr_reader</span> <span class="ss">:x</span><span class="p">,</span> <span class="ss">:y</span>

  <span class="k">def</span> <span class="nf">distance_to</span><span class="p">(</span><span class="n">other_point</span><span class="p">)</span>
    <span class="no">Math</span><span class="p">.</span><span class="nf">hypot</span><span class="p">(</span><span class="n">other_point</span><span class="p">.</span><span class="nf">x</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span> <span class="n">other_point</span><span class="p">.</span><span class="nf">y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">point_a</span> <span class="o">=</span> <span class="no">Point</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">point_b</span> <span class="o">=</span> <span class="no">Point</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

<span class="nb">p</span> <span class="n">point_a</span><span class="p">.</span><span class="nf">distance_to</span><span class="p">(</span><span class="n">point_b</span><span class="p">)</span>
</code></pre>
</div>

<p>If we instead include the <code class="highlighter-rouge">Math</code> module into the <code class="highlighter-rouge">Point</code> class, we see that the behavior is different than defining methods directly on the <code class="highlighter-rouge">Math</code> module because its functionality does get mixed into <code class="highlighter-rouge">Point</code>.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Point</span>
  <span class="kp">include</span> <span class="no">Math</span>

  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="vi">@x</span> <span class="o">=</span> <span class="n">x</span>
    <span class="vi">@y</span> <span class="o">=</span> <span class="n">y</span>
  <span class="k">end</span>

  <span class="kp">attr_reader</span> <span class="ss">:x</span><span class="p">,</span> <span class="ss">:y</span>

  <span class="k">def</span> <span class="nf">distance_to</span><span class="p">(</span><span class="n">other_point</span><span class="p">)</span>
    <span class="n">hypot</span><span class="p">(</span><span class="n">other_point</span><span class="p">.</span><span class="nf">x</span> <span class="o">-</span> <span class="n">x</span><span class="p">,</span> <span class="n">other_point</span><span class="p">.</span><span class="nf">y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">point_a</span> <span class="o">=</span> <span class="no">Point</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">point_b</span> <span class="o">=</span> <span class="no">Point</span><span class="p">.</span><span class="nf">new</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

<span class="nb">p</span> <span class="n">point_a</span><span class="p">.</span><span class="nf">distance_to</span><span class="p">(</span><span class="n">point_b</span><span class="p">)</span>
</code></pre>
</div>

<p>This pattern of having a module that doubles as a mixin and a singleton object probably has limited applications, but it seems reasonable for the <code class="highlighter-rouge">Math</code> module because each method provided by <code class="highlighter-rouge">Math</code> is purely functional and is also unlikely to clash with other features within a given class. But even if mixing in the <code class="highlighter-rouge">Math</code> module is convenient and relatively safe, we wouldn’t want our <code class="highlighter-rouge">Point</code> object to expose the features that the <code class="highlighter-rouge">Math</code> object provides via its public API. This is where we notice that <code class="highlighter-rouge">module_function</code> anticipates this potential problem and attempts to solve it by making all mixed-in methods private.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt; point_a.hypot(4,3)
NoMethodError: private method `hypot' called for #&lt;Point:0x0000010083bd68 @x=0, @y=0&gt;
    from (irb):20
    from /Users/seacreature/.rvm/rubies/ruby-1.9.3-rc1/bin/irb:16:in `&lt;main&gt;'
</code></pre>
</div>

<p>Though this is potentially a useful feature, we now must keep in mind that modules that utilize <code class="highlighter-rouge">module_function</code> do not have ordinary mixin behavior. However, this is not the main reason why I said that <code class="highlighter-rouge">module_function</code> is confusing. To generate our proper “WTF?” moment, we can attempt to use <code class="highlighter-rouge">module_function</code> to implement our <code class="highlighter-rouge">SimpleLogger</code> object.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">module</span> <span class="nn">SimpleLogger</span>
  <span class="kp">module_function</span>
  
  <span class="k">def</span> <span class="nf">output</span>
    <span class="vi">@output</span> <span class="o">||=</span> <span class="p">[]</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">error</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">&lt;&lt;</span> <span class="n">formatted_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s2">"ERROR"</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">&lt;&lt;</span> <span class="n">formatted_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s2">"INFO"</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="n">f</span> <span class="o">&lt;&lt;</span> <span class="n">output</span><span class="p">.</span><span class="nf">join</span> <span class="p">}</span>
  <span class="k">end</span>

  <span class="kp">private</span>

  <span class="k">def</span> <span class="nf">formatted_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">message_type</span><span class="p">)</span>
    <span class="s2">"</span><span class="si">#{</span><span class="no">Time</span><span class="p">.</span><span class="nf">now</span><span class="si">}</span><span class="s2"> | </span><span class="si">#{</span><span class="n">message_type</span><span class="si">}</span><span class="s2">: </span><span class="si">#{</span><span class="n">message</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<p>That implementation <em>almost</em> works, but ends up failing with an error that is quite surprising unless you know exactly how <code class="highlighter-rouge">module_function</code> works.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt; SimpleLogger.error("This won't actually succeed")
NoMethodError: undefined method `formatted_message' for SimpleLogger:Module
    from (irb):29:in `error'
    from (irb):50
    from /Users/seacreature/.rvm/rubies/ruby-1.9.3-rc1/bin/irb:16:in `&lt;main&gt;'
</code></pre>
</div>

<p>The reason this happens is multifaceted. When using <code class="highlighter-rouge">module_function</code> with no arguments, as we do, the public methods that are defined after the <code class="highlighter-rouge">module_function</code> call are treated as module functions and get copied onto the module itself. However, once the private keyword is reached, the methods are no longer treated as module functions and thus don’t end up getting copied onto the module. It is therefore effectively impossible to use <code class="highlighter-rouge">module_function</code> if you want to have your module methods call any private methods. If we accept this limitation and remove the <code class="highlighter-rouge">private</code> keyword from our <code class="highlighter-rouge">SimpleLogger</code> definition, things will work as expected using the original runner code from the previous examples.</p>

<p>If you made it through the previous example without becoming incredibly confused, try guessing what this code will do before running it, and then prepare to be surprised.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">module</span> <span class="nn">A</span>
  <span class="k">def</span> <span class="nf">x</span>
    <span class="mi">10</span>
  <span class="k">end</span>

  <span class="kp">module_function</span> <span class="ss">:x</span> 

  <span class="k">def</span> <span class="nf">x</span>
    <span class="mi">12</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="nb">p</span> <span class="no">A</span><span class="p">.</span><span class="nf">x</span>

<span class="k">class</span> <span class="nc">B</span>
  <span class="kp">include</span> <span class="no">A</span>
<span class="k">end</span>

<span class="nb">p</span> <span class="no">B</span><span class="p">.</span><span class="nf">new</span><span class="p">.</span><span class="nf">x</span>
</code></pre>
</div>

<p>If you managed to run this example without thinking that <code class="highlighter-rouge">module_function</code> is an abomination that should be removed from the Ruby language post-haste, please leave a convincing argument in the comments section. But you may want to first look at <code class="highlighter-rouge">module_function</code>’s slightly less awkward cousin, <code class="highlighter-rouge">extend self</code>.</p>

<h3 id="using-a-module-with-extend-self">Using a module with <code class="highlighter-rouge">extend self</code></h3>

<p>The main problem with <code class="highlighter-rouge">module_function</code> is that it has so many moving parts. You need to really understand a fairly broad range of Ruby concepts in order to use it effectively. But if we accept the notion that it’s sometimes useful for a singleton object to double as a mixin, we can try another approach that behaves similar to <code class="highlighter-rouge">module_function</code> without too many special cases to consider.</p>

<p>We can start by exploring a contrived example that demonstrates what happens when you use <code class="highlighter-rouge">extend</code> to mix a module into itself. If it’s not immediately obvious what the <code class="highlighter-rouge">extend self</code> line does, treat it as a black box for now and focus on how the objects behave as we call methods on them.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">module</span> <span class="nn">A</span>
  <span class="kp">extend</span> <span class="nb">self</span>

  <span class="k">def</span> <span class="nf">x</span>
    <span class="n">y</span>
  <span class="k">end</span>
  
  <span class="kp">private</span>

  <span class="k">def</span> <span class="nf">y</span>
    <span class="s2">"yay!"</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">B</span>
  <span class="kp">include</span> <span class="no">A</span>
<span class="k">end</span>

<span class="no">A</span><span class="p">.</span><span class="nf">x</span>      <span class="c1">#=&gt; "yay!"</span>
<span class="no">A</span><span class="p">.</span><span class="nf">y</span>      <span class="c1">#=&gt; raises NoMethodError: private method `y' called for A:Module</span>
<span class="no">B</span><span class="p">.</span><span class="nf">new</span><span class="p">.</span><span class="nf">x</span>  <span class="c1">#=&gt; "yay!"</span>
<span class="no">B</span><span class="p">.</span><span class="nf">new</span><span class="p">.</span><span class="nf">y</span>  <span class="c1">#=&gt; raises NoMethodError: private method `y' called for #&lt;B:...&gt;</span>
</code></pre>
</div>

<p>Speaking purely from the perspective of the externally visible behavior, we see that the key difference between <code class="highlighter-rouge">module_function</code> and <code class="highlighter-rouge">extend self</code> is that <code class="highlighter-rouge">extend self</code> results in identical behavior at both the module level and the mixin level when it comes to access control. Both private methods and public methods get mixed into the target object, and their access control is kept the same as whatever it was in the module definition. This is good because it means that your module can actually define private methods without any consequences. The main technical downside of this approach is that if <code class="highlighter-rouge">Math</code> were implemented in this way, including the <code class="highlighter-rouge">Math</code> module in a given object would add all the functions that can be called on the <code class="highlighter-rouge">Math</code> module to the public API of that object. There are workarounds to get that sort of behavior without <code class="highlighter-rouge">module_function</code>, but they’re cumbersome and not really worth talking about. Assuming that we don’t care about this subtle distinction, the following code will implement a working <code class="highlighter-rouge">SimpleLogger</code> singleton object that’s a bit easier to reason about than the <code class="highlighter-rouge">module_function</code> version:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="k">module</span> <span class="nn">SimpleLogger</span>
  <span class="kp">extend</span> <span class="nb">self</span>

  <span class="k">def</span> <span class="nf">output</span>
    <span class="vi">@output</span> <span class="o">||=</span> <span class="p">[]</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">error</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">&lt;&lt;</span> <span class="n">formatted_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s2">"ERROR"</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">&lt;&lt;</span> <span class="n">formatted_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s2">"INFO"</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="n">f</span> <span class="o">&lt;&lt;</span> <span class="n">output</span><span class="p">.</span><span class="nf">join</span> <span class="p">}</span>
  <span class="k">end</span>

  <span class="kp">private</span>

  <span class="k">def</span> <span class="nf">formatted_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">message_type</span><span class="p">)</span>
    <span class="s2">"</span><span class="si">#{</span><span class="no">Time</span><span class="p">.</span><span class="nf">now</span><span class="si">}</span><span class="s2"> | </span><span class="si">#{</span><span class="n">message_type</span><span class="si">}</span><span class="s2">: </span><span class="si">#{</span><span class="n">message</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Even if the <code class="highlighter-rouge">extend self</code> approach is more fundamentally simple than <code class="highlighter-rouge">module_function</code>, it is not necessarily easy to learn or easy to understand. I go into great detail explaining exactly how this technique works in <a href="http://blog.rubybestpractices.com/posts/gregory/040-issue-10-uses-for-modules.html">Practicing Ruby 1.10</a>, but the two pages it takes me to explain it at a very high level serve as a hint that we’re probably trying too hard to be clever when we write code this way.</p>

<p>So far, we’ve gone down a deep bunny hole because each alternative approach we’ve attempted was about solving a problem with the previous implementation. But for every improvement we make, we lose something in return. Much of our struggle has to do with the costs involved in trying to implement a singleton object that conforms to the expectations we have about classes and modules. To sidestep this issue, we can think about a solution that works directly with an individual object instead.</p>

<h3 id="using-a-bare-instance-of-object">Using a bare instance of <code class="highlighter-rouge">Object</code></h3>

<p>The following code shows how to implement the singleton pattern by adding methods to a bare instance of <code class="highlighter-rouge">Object</code>. This code may look a bit strange at first but is at its core the same as defining methods on any other Ruby object, including instances of the <code class="highlighter-rouge">Module</code> and <code class="highlighter-rouge">Class</code> classes.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="no">SimpleLogger</span> <span class="o">=</span> <span class="no">Object</span><span class="p">.</span><span class="nf">new</span>
<span class="k">class</span> <span class="o">&lt;&lt;</span> <span class="no">SimpleLogger</span>
  <span class="k">def</span> <span class="nf">output</span>
    <span class="vi">@output</span> <span class="o">||=</span> <span class="p">[]</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">error</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">&lt;&lt;</span> <span class="n">formatted_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s2">"ERROR"</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="n">output</span> <span class="o">&lt;&lt;</span> <span class="n">formatted_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="s2">"INFO"</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="n">f</span> <span class="o">&lt;&lt;</span> <span class="n">output</span><span class="p">.</span><span class="nf">join</span> <span class="p">}</span>
  <span class="k">end</span>

  <span class="kp">private</span>

  <span class="k">def</span> <span class="nf">formatted_message</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">message_type</span><span class="p">)</span>
    <span class="s2">"</span><span class="si">#{</span><span class="no">Time</span><span class="p">.</span><span class="nf">now</span><span class="si">}</span><span class="s2"> | </span><span class="si">#{</span><span class="n">message_type</span><span class="si">}</span><span class="s2">: </span><span class="si">#{</span><span class="n">message</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Although we didn’t have to store the object in the <code class="highlighter-rouge">SimpleLogger</code> constant, doing so makes the familiar runner code we’ve been using over and over work exactly as expected.</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="no">SimpleLogger</span><span class="p">.</span><span class="nf">error</span><span class="p">(</span><span class="s2">"Some serious problem"</span><span class="p">)</span>
<span class="no">SimpleLogger</span><span class="p">.</span><span class="nf">info</span><span class="p">(</span><span class="s2">"Something you might want to know"</span><span class="p">)</span>
<span class="no">SimpleLogger</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="s2">"log.txt"</span><span class="p">)</span>
</code></pre>
</div>

<p>The code looks and feels the same from the end-user’s perspective, but we know that there is something quite different hiding under the hood. The good news is that this approach makes it so that our <code class="highlighter-rouge">SimpleLogger</code> is not a factory for creating new objects like classes are and cannot be mixed into other objects or part of a hierarchy. The bad news is that the resulting object is very opaque. When we inspect a class or module object, it at least gives us back its name. However, when we inspect this object, what we get is the following:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&gt;&gt; SimpleLogger
=&gt; #&lt;Object:0x0000010084bc18&gt;
</code></pre>
</div>

<p>Documenting this object using something like RDoc would be similarly frustrating, as it wouldn’t be able to infer much about the object without lots of explicit directives. Although Ruby is designed in terms of ordinary objects, its infrastructure is surely defined in terms of classes and modules.</p>

<p>We can’t do anything about the documentation problem without major changes to Ruby, but we might be able to build our own custom construct that takes these basic ideas and adds better debugging support.</p>

<h3 id="using-a-hand-rolled-construct">Using a hand-rolled construct</h3>

<p>A few days before writing this article, I complained on Twitter about the lack of a good way to implement the singleton pattern in Ruby and suggested that perhaps we needed a new first-order construct for these purposes. Someone was quick to point out that <a href="http://hestia.typepad.com/flatlander/2009/01/scala-for-c-programmers-part-2-singletons.html">Scala has such a construct</a>, which got the wheels turning in my head. As a point of reference, here’s what the construct looks like in Scala:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>object Universe {
  def contains(obj: Any): Boolean = true  
}

val v = Universe.contains(42)
</code></pre>
</div>

<p>Now, there is a big difference between having built-in support for something in a language and building some sort of hand-rolled approximation. However, I couldn’t resist implementing a construct in Ruby that works roughly the same way as this Scala code. After some tinkering, I settled on this syntax:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">object</span> <span class="s2">"Universe"</span> <span class="k">do</span>
  <span class="k">def</span> <span class="nf">contains?</span><span class="p">(</span><span class="n">anything</span><span class="p">)</span>
    <span class="kp">true</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="nb">p</span> <span class="no">Universe</span><span class="p">.</span><span class="nf">contains?</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span> <span class="c1">#=&gt; true</span>
<span class="nb">p</span> <span class="no">Universe</span> <span class="c1">#=&gt; #&lt;Universe:2156157600&gt;  </span>
</code></pre>
</div>

<p>Because the call to <code class="highlighter-rouge">object</code> hides the actual object creation, I was able to add nice <code class="highlighter-rouge">inspect</code> output in a way that is transparent to the user. Similar debugging and introspection features could be added just as easily. Under the hood, I used an approach similar to working with bare objects, so I retain all the benefits of that approach while getting rid of some of the downsides. (NOTE: I’ve decided to leave implementing this construct as a homework exercise, but please let me know if you get stuck and want to see how I did it.)</p>

<p>Looking back on this code, I like the way the experiment went, but I am stuck wondering whether it makes sense to take it any farther. Without first-order support in the Ruby language for this construct, documentation would still be a struggle. Also, the awkward syntax breaks consistency with <code class="highlighter-rouge">Class</code> and <code class="highlighter-rouge">Module</code>. What we’d really want to be able to type is something like the following definition:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">object</span> <span class="no">Universe</span> 
  <span class="k">def</span> <span class="nf">contains?</span><span class="p">(</span><span class="n">anything</span><span class="p">)</span>
    <span class="kp">true</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<p>Although the previous example is syntactically pleasing to me, I wonder if encouraging us to use more global functionality (and on a related note, more constants) is a good idea. At a minimum, such a change would need to also be mirrored in <code class="highlighter-rouge">Object.new</code> by adding a block form similar to the way that <code class="highlighter-rouge">Module</code> and <code class="highlighter-rouge">Class</code> work. This approach would end up looking something like this:</p>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="n">universe</span> <span class="o">=</span> <span class="no">Object</span><span class="p">.</span><span class="nf">new</span> <span class="k">do</span>
  <span class="k">def</span> <span class="nf">contains?</span><span class="p">(</span><span class="n">anything</span><span class="p">)</span>
    <span class="kp">true</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>

<p>The thing we have to ask ourselves is whether these features would really make Ruby a better language to work in. To answer that question, we need to consider the costs and benefits of avoiding the singleton pattern entirely.</p>

<h3 id="avoiding-the-singleton-pattern-entirely">Avoiding the singleton pattern entirely</h3>

<p>Pretty much everything discussed so far is about avoiding explictly instantiating objects, which makes it possible for us to put off potentially expensive setup work and also makes it easier for us to prevent multiple instances of a given object from being instantiated within our applications. Some of our implementations do a good job of communicating these desires to the user by preventing them from creating instances. Others encourage a limited form of code reuse through module mixins, but with a number of caveats attached.</p>

<p>But in the end, we must not forget that the singleton pattern is essentially just a fancy way of managing global state. If we converted our <code class="highlighter-rouge">SimpleLogger</code> into an ordinary class and then did something like <code class="highlighter-rouge">$logger = SimpleLogger.new</code>, there would be marginal practical difference in the way things worked in our codebase. Things change slightly when we think of function bags like the <code class="highlighter-rouge">Math</code> module, but not as much as you might think. We must remember that no matter what form our singleton objects take, each one we add to our system is by definition less reusable and less testable due to its singular, global nature.</p>

<p>The question of whether to implement the singleton pattern really depends on the context, but it’s safe to say that it’s a bad default. However, this is a genuinely hard problem in object-oriented programming, which may explain why we’ve seen so many different attempts in Ruby without a real consensus on which way is best. We’ve also been unable to eliminate the pattern entirely, which is a sign that we can’t simply write it off as one of those bad Java imports that real Rubyists freely ignore.</p>

<h3 id="reflections">Reflections</h3>

<p>The process of writing this article has taught me a few things. First of all, most of the approaches we take to implement the singleton pattern are way too complicated. Although this grail quest for object-oriented purity is entertaining from an academic perspective, it isn’t something we should need to think about in our daily coding lives.</p>

<p>That said, it seems like a first-order construct that lets us define individual objects in an elegant way would be an interesting addition to Ruby. If we gravitated toward a more prototype-based design style via these standalone objects while using modules for our code reuse, we might end up with very nice solutions that would make this “singleton object” problem just disappear. But then again, that would be a huge shift in the way we write Ruby code, and I’m not sure the juice is worth the squeeze.</p>

<p>In the end, it amazes me that I was able to write so much on this topic, but not in a good way. As powerful as Ruby-the-language is, it seems that we’re still far from being able to balance that power with responsibility. Every approach I criticized in this article is one I’ve advocated for at some earlier point, and now I’m not so sure I like any of them.</p>

<p>My hope is that you got two things from reading this article: a deeper understanding of the complexity of Ruby’s object system and an awareness of the trade-offs of various approaches to this problem, so that you can be better equipped when you encounter this sort of design in the wild. If I’ve accomplished that, then this article was well worth the effort it took to write up. If not, don’t worry: we’ll return to more practical content next week! :)</p>

  </div>

  <div style="text-align: center">
    <h3><a href="/">Want to keep reading? Check out the archives for more.</a></h3>

    <small>Practicing Ruby is proudly independent, open source, and advertising free.<br/>If you insist on being asked for something in return, check out <a href="/support">how to support my work</a>.</small>
  </div>

</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">
    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>Send questions and feedback to:</li>
          <li><a href="mailto:gregory@practicingdeveloper.com">gregory@practicingdeveloper.com</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/practicingdeveloper"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">practicingdeveloper</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/practicingdev"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">practicingdev</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>The world's largest collection of lessons for experienced Ruby developers.
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
